version: 2

models:
  - name: V_CONTROL_SCORE_SUMMARY
    description: >
      Summary view aggregating the latest snapshot from RESULTS_CONTROL_SCORE_2.
      Provides a quick overview of control scores with their status distributions.
    meta:
      owner: Fraud Team / dan_leds@document_fraud.com
    columns:
      - name: control_score
        description: Control score category
        tests:
          - not_null
          - unique
      - name: total_documents
        description: Total count of documents for this control score
        tests:
          - not_null
      - name: count_ok
        description: Count of documents with OK status
      - name: count_ko
        description: Count of documents with KO status
      - name: count_na
        description: Count of documents with NA status
      - name: count_null
        description: Count of documents with NULL/unknown status
      - name: perc_ok
        description: Percentage of OK status
      - name: perc_ko
        description: Percentage of KO status
      - name: last_update
        description: Date of the last snapshot used
